# 変数の構造

Bakin での変数は、以下の４つのスコープが確認できました。  

* ゲーム全体で使える（いわゆる　グローバル；Global。 Bakin がいうところの **通常**）
* グローバルで、かつ、他のセーブスロットと内容を共有する **セーブ間共有**
* ゲームオブジェクト・インスタンス（Bakin が言うところの **イベント**）のプロパティ変数（Bakin が言うところの **ローカル**）
* Bakin が言うところの **コモンイベント** のローカル変数（Bakin が言うところの **ローカル**）

また、静的型付け（スタティック・タイピング）ではなく、ダック型付け（ダックタイピング）に近いです。  
例えば変数は：  

* 数値のように利用すれば数値に
* 文字列のように利用すれば文字列に
* イベントスイッチのように利用すればイベントスイッチに

ただし、暗黙の変換がどのように行われるかには気をつけましょう。後述します。  

細かく見ていくと：  
数値スカラー型、文字列スカラー型の２つの型が確認できます。  
数値スカラー型には、いわゆる　整数スカラー値、浮動小数点スカラー値が入ります。  
Bakin で割り切れない割り算をするときは整数スカラー値から浮動小数点スカラー値へ型が変わります。  

また、グローバル・スコープ変数でのみ、整数スカラー値、浮動小数点スカラー値、文字列スカラー型のそれぞれについての **配列** が確認できます。  
セーブ間共有というスコープには、配列は確認できません。  

また、ブーリアン型はありません。（後述［様々な変数をイベントスイッチとして使ったときの説明］参照）  
クラスは確認できません。従って変数は静的であり、そしてメソッドを持たず、データの格納のみを行います。  

プログラマーから見た変数:  

|                                                                                                | K.整数スカラー値 | L.浮動小数点スカラー値 | M.文字列スカラー型 | N.整数スカラー値配列 | O.浮動小数点スカラー値配列 | P.文字列型配列 |
|------------------------------------------------------------------------------------------------|:----------------:|:----------------------:|:------------------:|:--------------------:|:--------------------------:|:--------------:|
| A.セーブ間共有スコープ                                                                         |        ✓         |           ✓           |         ✓         |                       |                            |                |
| B.グローバル・スコープ                                                                         |        ✓         |           ✓           |         ✓         |           ✓          |              ✓             |        ✓       |
| C.ゲームオブジェクト・インスタンス・スコープ<br/>及び<br/>D.コモンイベント・ローカル・スコープ |        ✓         |           ✓           |         ✓         |                       |                            |                |

プログラマーから見た、バキナーとの間で翻訳するために必要になる、上図との対応表:  

|                                                                                                | K.変数ボックス または K.イベントスイッチ | L.変数ボックス       | M.文字列変数     | N.変数ボックス 配列 | O.変数ボックス 配列 | P.文字列変数 配列 |
|------------------------------------------------------------------------------------------------|:----------------------------------------:|:--------------------:|:----------------:|:-------------------:|:-------------------:|:-----------------:|
| A.セーブ間共有                                                                                 |                     ✓                    |          ✓          |        ✓        |                      |                     |                   |
| B.通常                                                                                         |                     ✓                    |          ✓          |        ✓        |          ✓           |         ✓          |        ✓         |
| C,D.ローカル                                                                                   |                     ✓                    |          ✓          |        ✓        |                      |                     |                   |

バキナーから見た変数:  

|                              | K,L.変数ボックス | M.文字列変数     | N,O.変数ボックス 配列 | P.文字列変数 配列 | K.イベントスイッチ |
|------------------------------|:----------------:|:----------------:|:---------------------:|:-----------------:|:------------------:|
| A.セーブ間共有               |         ✓        |        ✓        |                       |                   |          ✓         |
| B.通常                       |         ✓        |        ✓        |          ✓            |         ✓        |          ✓         |
| C,D.ローカル                 |         ✓        |        ✓        |                       |                   |          ✓         |

# ダックタイピング

## 文字列を数値（変数ボックス）として使ったときの説明

例えば文字列 ""（空文字列）、 "ああああ" を数値ボックスとして取得すると、ともに 0 として取り出せました。  

所感： 文字列が入っていても 0 になるのは、 Ｃ言語などで採用されている ［0以外は真］ という一貫性から外れるので注意が必要でしょう。  


## 数値を文字列として使ったときの説明

0, 0.1, "ああああ" は、そのまま "0", "0.1", "ああああ" として取り出せました。  
イベントスイッチのオンは "1"、オフは "0" として取り出せました。

## 様々な変数をイベントスイッチとして使ったときの説明

数値スカラー型を使って 0 や 0.0 ならオフ、それ以外の数ならオン。  
ただし文字列スカラー型を使った場合は "0" や "0.0" ならオフ、それ以外の数ならオン、空文字列ならがオフまでは対象的ですが、  
（確認した限りでは）それ以外の文字が入っているケースはオンになるので、一貫性の破れを感じます。  
Bakin ではこのような使い方を **イベントスイッチ** と呼びます。  
📺 [イベントスイッチの確認動画](https://x.com/muzudho1/status/1860649798468333829)  

## その他

📺 [マップ上のイベントと、コモンイベントのローカル変数は別物](https://x.com/muzudho1/status/1863185721731018987)  
